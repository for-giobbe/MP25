# coalescence-based inferences & ILS

--- 

### gene tree(s) inference

Coalescent -based methods are (mostly) based on gene trees .. so let's start by inferring some:

```bash
iqtree2 -S data/example_alignements/aa --prefix loci
```

Then we can see that there ten different trees have been produced in the file ```loci.treefile```. It is istantly clear that they are different ... but what if we want to measure discordance? 

For this purpose, IQ-TREE implements the Robinson-Foulds distances calculation, a metric able to compare topologies between **binary** but **unrooted** trees (see [here](https://www.cs.hmc.edu/~hadas/mitcompbio/treedistance.html) for an in-depth explanation on computational methods). Let's calculate them using:

```bash
iqtree -t loci.treefile -rf_all
```

However

### Task!
> A friend of yours has told you that ```ete3 ``` implements a lot of distance metrics between trees ... install it and calculate some _normalyzed_ distances.

--- 

### coalescence-based species-tree inference

Now we can move to the actual species tree inference, starting from gene trees:

```bash
astral -i loci.treefile 
```
This is what will be printed on the screen, which reflects
```bash
#Genetrees: 10
#Species: 8
#Rounds: 4
#Samples: 4
#Threads: 1
#NNI moves:0/36
(((((P_fucata,C_virginica),S_constricta),(B_glabrata,L_gigantea)),(A_granulata,O_bimaculoides)),H_robusta);
#NNI moves:0/36
((((((P_fucata,C_virginica),S_constricta),(L_gigantea,B_glabrata)),H_robusta),O_bimaculoides),A_granulata);
#NNI moves:0/36
((((((A_granulata,O_bimaculoides),H_robusta),(B_glabrata,L_gigantea)),S_constricta),P_fucata),C_virginica);
#NNI moves:0/36
((((((O_bimaculoides,A_granulata),H_robusta),(L_gigantea,B_glabrata)),S_constricta),P_fucata),C_virginica);
Initial score: 470
Initial tree: ((O_bimaculoides,(H_robusta,((L_gigantea,B_glabrata),(S_constricta,(P_fucata,C_virginica))))),A_granulata);
*** Subsample Process ***
#NNI moves:0/36
((((((C_virginica,P_fucata),S_constricta),(L_gigantea,B_glabrata)),H_robusta),O_bimaculoides),A_granulata);
#NNI moves:0/36
((((((O_bimaculoides,A_granulata),H_robusta),(L_gigantea,B_glabrata)),S_constricta),P_fucata),C_virginica);
#NNI moves:0/36
(((((A_granulata,O_bimaculoides),H_robusta),((P_fucata,C_virginica),S_constricta)),L_gigantea),B_glabrata);
#NNI moves:0/36
(((((C_virginica,P_fucata),S_constricta),(L_gigantea,B_glabrata)),(A_granulata,O_bimaculoides)),H_robusta);
Current score: 470
Current tree: ((O_bimaculoides,((((C_virginica,P_fucata),S_constricta),(L_gigantea,B_glabrata)),H_robusta)),A_granulata);
Final Tree: ((O_bimaculoides,((((C_virginica,P_fucata),S_constricta),(L_gigantea,B_glabrata)),H_robusta)),A_granulata);
((O_bimaculoides:0.817934,((((C_virginica:0.221151,P_fucata:0.251133)0.999704:0.167198,S_constricta:0.415062)0.974288:0.027019,(L_gigantea:0.304880,B_glabrata:0.491562)0.821452:0.029472)0.791118:0.043285,H_robusta:0.724897)0.495476:0.007902):0.143127,A_granulata:0.143127);
Score: 470
```

If you did not specify any output file, the final tree will be printed to the screen.

---

### [main](https://github.com/for-giobbe/MP25/tree/main)